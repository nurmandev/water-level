<!DOCTYPE html>
<html>
  <head>
    <%- include('partials/head'); %>
  </head>
  <body>
    <%- include('navbar', { user: null }); %>
    <!-- ***** Header Area End ***** -->
    <div id="services" class="services section">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 offset-lg-2">
            <div
              class="section-heading wow fadeInDown"
              data-wow-duration="1s"
              data-wow-delay="0.5s"
            >
              <h2>Water <em>Level</em></h2>
              <img src="assets/images/heading-line-dec.png" alt="" />
              <p>
                Water tank overflow is a common problem which leads to the
                wastage of water. Though there are many solutions to it like
                ball valves which automatically stop the water flow once the
                tank gets full.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container">
      <div class="card-deck">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title">Tank</h5>
            <div class="progress progress-bar-vertical">
              <div
                class="progress-bar progress-bar-danger bg-info progress-bar-striped progress-bar-animated"
                role="progressbar"
                aria-valuenow="<%= sensorData ? sensorData.distance : 0 %>"
                aria-valuemin="0"
                aria-valuemax="100"
                id="tankProgress"
                style="height: <%= sensorData ? sensorData.distance : 0 %>%"
              >
                <div class="container">
                  <span class="sr-only" id="tankPercentage"
                    ><%= sensorData ? sensorData.distance : 0 %>%</span
                  >
                </div>
              </div>
            </div>
            <div class="container">
              <p id="distance">
                Tank is filled up for: <%= sensorData ? sensorData.distance : 0
                %>%
              </p>
            </div>
            <div class="card-footer container">
              <small class="text-muted" id="status"
                >Status: Monitoring...</small
              >
            </div>
          </div>
        </div>
        <div class="card">
          <div class="card-body">
            <h5 class="card-title">History</h5>
            <canvas id="historyChart"></canvas>
          </div>
          <div class="card-footer">
            <small class="text-muted">Last updated # mins ago</small>
          </div>
        </div>
      </div>
    </div>

    <div id="about" class="services section">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 offset-lg-2">
            <div
              class="section-heading wow fadeInDown"
              data-wow-duration="1s"
              data-wow-delay="0.5s"
            >
              <h2>Project Team</h2>
              <img src="assets/images/heading-line-dec.png" alt="" />
              <p>Meet the team</p>

              <div class="team-members">
                <!-- ΝΕΡΩΝ -->
                <div class="member">
                  <img src="assets/members/neron.jpg" alt="Member 1" />
                  <h5>Bn Illihas</h5>
                  <p>Project Leader</p>
                  <div class="social-links">
                    <a href="https://github.com/" target="_blank"
                      ><i class="fab fa-github"></i
                    ></a>
                    <a href="https://www.linkedin.com/in/" target="_blank"
                      ><i class="fab fa-linkedin"></i
                    ></a>
                  </div>
                </div>
                <!-- ΚΩΝΣΤΑΝΤΙΝΟΣ -->
                <div class="member">
                  <img src="assets/members/konstantinos.jpg" alt="Member 2" />
                  <h5>IIiii</h5>
                  <p>Project Cordinator</p>
                  <div class="social-links">
                    <a href="https://github.com/" target="_blank"
                      ><i class="fab fa-github"></i
                    ></a>
                    <a href="https://www.linkedin.com/in/" target="_blank"
                      ><i class="fab fa-linkedin"></i
                    ></a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="faq" class="pricing-tables">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 offset-lg-2">
            <div class="section-heading">
              <h2>Frequently Asked <em>Questions</em></h2>
              <img src="assets/images/heading-line-dec.png" alt="" />
              <p>
                Here are some frequently asked questions about the project, its
                setup, and operation, along with my answers.
              </p>
            </div>
          </div>

          <div class="faq-container">
            <div class="faq">
              <h3 class="faq-title">
                How does the water level indicator work?
              </h3>
              <p class="faq-text">
                The water level indicator operates using Emitter, which allows
                it to accurately detect water levels in tanks or reservoirs.
                Sensors are strategically placed at different levels, sending
                signals to the microcontroller, which then interprets and
                displays the water level information.
              </p>
              <button class="faq-toggle">
                <i class="fas fa-chevron-down"></i>
                <i class="fas fa-times"></i>
              </button>
            </div>
            <div class="faq">
              <h3 class="faq-title">
                What types of tanks or containers is the water level indicator
                suitable for?
              </h3>
              <p class="faq-text">
                Our water level indicator is versatile and can be used in
                various types of tanks. It is adaptable to different shapes and
                sizes, making it suitable for residential, commercial, and
                industrial applications.
              </p>
              <button class="faq-toggle">
                <i class="fas fa-chevron-down"></i>
                <i class="fas fa-times"></i>
              </button>
            </div>
            <div class="faq">
              <h3 class="faq-title">
                What are the benefits of using the water level indicator?
              </h3>
              <p class="faq-text">
                The water level indicator offers several benefits, including:
                <br />
                Efficient water management: Helps prevent water wastage by
                providing accurate real-time monitoring of water levels. <br />
                Convenience: Eliminates the need for manual checking of water
                levels, saving time and effort. <br />
                Prevents overflow or shortage: Alerts users when water levels
                are too high or too low, preventing potential damage or
                inconvenience. <br />
                Cost-effective: Promotes water conservation, leading to reduced
                water bills and operational costs.
              </p>
              <button class="faq-toggle">
                <i class="fas fa-chevron-down"></i>
                <i class="fas fa-times"></i>
              </button>
            </div>
            <div class="faq">
              <h3 class="faq-title">
                Is the water level indicator easy to install and use?
              </h3>
              <p class="faq-text">
                Yes, the installation process is straightforward and
                user-friendly. We provide detailed instructions and support
                materials to guide you through the setup process. Once
                installed, the device operates automatically, requiring minimal
                maintenance. Our user manual offers step-by-step instructions
                for seamless operation.
              </p>
              <button class="faq-toggle">
                <i class="fas fa-chevron-down"></i>
                <i class="fas fa-times"></i>
              </button>
            </div>
            <div class="faq">
              <h3 class="faq-title">
                Can the water level indicator be integrated with other systems
                or smart home devices?
              </h3>
              <p class="faq-text">
                Yes, our water level indicator is designed to be compatible with
                various smart home automation systems. It allowing for seamless
                monitoring and control of water levels remotely. Integration
                instructions and support are available upon request.
              </p>
              <button class="faq-toggle">
                <i class="fas fa-chevron-down"></i>
                <i class="fas fa-times"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="contact" class="pricing-tables">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 offset-lg-2">
            <div class="section-heading">
              <h4>Contact</h4>
              <img src="assets/images/heading-line-dec.png" alt="" />
              <p>
                Have questions or feedback? Please fill out this form to get in
                touch.
              </p>
            </div>
          </div>
          <div class="col-lg-6 offset-lg-3">
            <div class="formbold-main-wrapper">
              <!-- Author: FormBold Team -->
              <!-- Learn More: https://formbold.com -->
              <div class="formbold-form-wrapper">
                <form action="" method="POST">
                  <div class="formbold-mb-5">
                    <label for="name" class="formbold-form-label">
                      First Name
                    </label>
                    <input
                      type="text"
                      name="name"
                      id="name"
                      placeholder="first name"
                      class="formbold-form-input"
                    />
                  </div>

                  <div class="formbold-mb-5">
                    <label for="department" class="formbold-form-label">
                      Last Name
                    </label>
                    <input
                      type="department"
                      name="text"
                      id="department"
                      placeholder="last name"
                      class="formbold-form-input"
                    />
                  </div>

                  <div class="formbold-mb-5">
                    <label for="subject" class="formbold-form-label">
                      Subject
                    </label>
                    <input
                      type="text"
                      name="subject"
                      id="subject"
                      placeholder="subject"
                      class="formbold-form-input"
                    />
                  </div>

                  <div class="formbold-mb-5">
                    <label for="message" class="formbold-form-label">
                      Message
                    </label>
                    <textarea
                      rows="6"
                      name="message"
                      id="message"
                      placeholder="message"
                      class="formbold-form-input"
                    ></textarea>
                  </div>

                  <div>
                    <button type="submit" class="formbold-btn">
                      Contact us
                    </button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <%- include('partials/footer'); %> <%- include('partials/footerSec'); %>

    <!-- MAIN CODE -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>
    <script>
      const tankProgress = document.getElementById("tankProgress");
      const tankPercentage = document.getElementById("tankPercentage");
      const distanceElement = document.getElementById("distance");
      const statusElement = document.getElementById("status");
      const historyChartElement = document.getElementById("historyChart");

      const historyData = {
        labels: [],
        datasets: [
          {
            label: "Water Level (%)",
            data: [],
            borderColor: "rgba(75, 192, 192, 1)",
            backgroundColor: "rgba(75, 192, 192, 0.2)",
            borderWidth: 1,
          },
        ],
      };

      const historyChart = new Chart(historyChartElement, {
        type: "line",
        data: historyData,
        options: {
          scales: {
            y: {
              beginAtZero: true,
              max: 100,
            },
          },
        },
      });

      function updateTankData(data) {
        const percentage = ((50 - data.distance) / 50) * 100;
        tankProgress.style.height = `${percentage}%`;
        tankProgress.setAttribute("aria-valuenow", percentage);
        tankPercentage.innerText = `${percentage.toFixed(2)}%`;
        distanceElement.innerText = `Tank is filled up for: ${percentage.toFixed(
          2
        )}%`;
        statusElement.innerText = `Status: Monitoring...`;

        const now = new Date();
        const timeLabel = `${now.getHours()}:${now.getMinutes()}:${now.getSeconds()}`;
        historyData.labels.push(timeLabel);
        historyData.datasets[0].data.push(percentage);
        historyChart.update();
      }

      async function fetchSensorData() {
        try {
          const response = await fetch("/sensor-data");
          const data = await response.json();
          updateTankData(data);
        } catch (error) {
          console.error("Error fetching sensor data:", error);
        }
      }

      async function startMonitoring() {
        await fetchSensorData();
        setInterval(fetchSensorData, 60000);
      }

      startMonitoring();
    </script>
  </body>
</html>
